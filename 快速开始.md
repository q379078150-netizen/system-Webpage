# 快速开始指南

## 第一步：安装依赖

```bash
pip install -r requirements.txt
```

## 第二步：配置环境变量

1. 复制环境变量示例文件：
```bash
# Windows PowerShell
Copy-Item .env.example .env

# Linux/Mac
cp .env.example .env
```

2. 编辑 `.env` 文件，填入您的配置：

### Ghost配置（主站）
```env
GHOST_URL=https://your-ghost-site.com
GHOST_ADMIN_API_KEY=your-ghost-admin-api-key
```

**如何获取Ghost API Key：**
1. 登录Ghost管理后台
2. 进入 Settings > Integrations
3. 点击 Add custom integration
4. 复制 Admin API Key

### Telegram配置
```env
TELEGRAM_BOT_TOKEN=your-bot-token
TELEGRAM_CHAT_ID=your-chat-id
```

**如何获取Telegram配置：**
1. 在Telegram中搜索 @BotFather
2. 发送 `/newbot` 创建新Bot
3. 按提示设置Bot名称和用户名
4. 复制Bot Token
5. 获取Chat ID：
   - 将Bot添加到您的频道/群组
   - 访问 `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
   - 查找 `chat.id` 字段

### Discord配置
```env
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/your-webhook-url
```

**如何获取Discord Webhook：**
1. 进入Discord服务器设置
2. 进入 Integrations > Webhooks
3. 点击 New Webhook
4. 复制Webhook URL

### Insight.ai配置（用于每日简报）
```env
INSIGHT_AI_GHOST_URL=https://insight.ai
INSIGHT_AI_ADMIN_API_KEY=your-insight-admin-key
```

## 第三步：启动服务

```bash
python app.py
```

服务将在 `http://0.0.0.0:8080` 启动。

## 第四步：测试系统

### 1. 健康检查
```bash
curl http://localhost:8080/api/health
```

### 2. 创建测试情报
```bash
curl -X POST http://localhost:8080/api/intelligence \
  -H "Content-Type: application/json" \
  -d '{
    "title": "测试情报",
    "content": "这是一条测试情报内容",
    "source": "测试来源",
    "rating": 5
  }'
```

如果rating是4或5，系统会自动推送到所有配置的渠道。

### 3. 查看情报列表
```bash
curl http://localhost:8080/api/intelligence
```

### 4. 手动触发推送
```bash
curl -X POST http://localhost:8080/api/push/1
```

### 5. 生成每日简报
```bash
curl -X POST http://localhost:8080/api/digest/generate \
  -H "Content-Type: application/json" \
  -d '{
    "date": "2024-01-01"
  }'
```

## 功能说明

### 实时推送（4-5星）
- 当创建或更新情报时，如果评级为4或5星，系统会自动推送到：
  - Ghost官网（发布文章）
  - Telegram（发送消息）
  - Discord（发送Webhook消息）

### 每日简报（3星以上）
- 系统会在每天00:00 UTC自动生成简报
- 汇总当日所有3星以上情报
- 自动发布到insight.ai首页

### 手动操作
- 可以通过API手动触发推送
- 可以手动生成和发布简报

## 常见问题

### Q: 推送失败怎么办？
A: 检查日志文件 `logs/app.log`，查看具体错误信息。常见原因：
- API密钥错误
- 网络连接问题
- 目标平台服务异常

### Q: 如何修改每日简报生成时间？
A: 在 `config.py` 中修改 `DIGEST_GENERATION_TIME` 配置。

### Q: 如何查看推送日志？
A: 访问 `/api/push/logs` API端点。

## 下一步

- 阅读完整的架构方案：`情报推送系统架构方案.md`
- 查看API文档：`README.md`
- 自定义情报分级规则：`backend/intelligence/classifier.py`
- 自定义内容格式：`backend/publishers/formatter.py`
